<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìä –ê–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—å - PantelMed</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f8f9fa;
            color: #333;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .login-section {
            max-width: 400px;
            margin: 100px auto;
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .login-section h2 {
            margin-bottom: 30px;
            color: #333;
        }
        
        .login-section input {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
        }
        
        .login-section button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 20px;
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-left: 4px solid;
            transition: transform 0.2s;
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
        }
        
        .stat-card.revenue { border-left-color: #28a745; }
        .stat-card.users { border-left-color: #007bff; }
        .stat-card.conversion { border-left-color: #ffc107; }
        .stat-card.active { border-left-color: #17a2b8; }
        
        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .section {
            background: white;
            margin: 20px 0;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .section-header {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .section-title {
            font-size: 1.3em;
            font-weight: 600;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            transition: background-color 0.2s;
        }
        
        .btn-primary { background: #007bff; color: white; }
        .btn-success { background: #28a745; color: white; }
        .btn-warning { background: #ffc107; color: white; }
        .btn-danger { background: #dc3545; color: white; }
        
        .table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .table th, .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }
        
        .table th {
            background: #f8f9fa;
            font-weight: 600;
        }
        
        .table tbody tr:hover {
            background: #f8f9fa;
        }
        
        .status-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: 600;
        }
        
        .status-active { background: #d4edda; color: #155724; }
        .status-pending { background: #fff3cd; color: #856404; }
        .status-failed { background: #f8d7da; color: #721c24; }
        
        .real-time-log {
            background: #1e1e1e;
            color: #00ff00;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            height: 300px;
            overflow-y: auto;
        }
        
        .alert {
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid;
        }
        
        .alert-info { background: #d1ecf1; border-left-color: #17a2b8; color: #0c5460; }
        .alert-warning { background: #fff3cd; border-left-color: #ffc107; color: #856404; }
        .alert-danger { background: #f8d7da; border-left-color: #dc3545; color: #721c24; }
        .alert-success { background: #d4edda; border-left-color: #28a745; color: #155724; }
        
        .hidden { display: none; }
        
        .logout-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid white;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .refresh-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #007bff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- –õ–û–ì–Ü–ù –°–ï–ö–¶–Ü–Ø -->
    <div id="login-section" class="login-section">
        <h2>üîê –í—Ö—ñ–¥ –≤ –∞–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—å</h2>
        <p>–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –ø–∞–Ω–µ–ª—ñ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è</p>
        <input type="password" id="admin-password" placeholder="–ü–∞—Ä–æ–ª—å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞" onkeypress="handlePasswordKeyPress(event)">
        <button onclick="adminLogin()">üöÄ –£–≤—ñ–π—Ç–∏</button>
        <div id="login-error" style="color: red; margin-top: 10px; display: none;"></div>
    </div>

    <!-- –ê–î–ú–Ü–ù –ü–ê–ù–ï–õ–¨ (–ü–†–ò–•–û–í–ê–ù–û) -->
    <div id="admin-panel" class="hidden">
        <div class="header">
            <h1>üìä –ê–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—å PantelMed</h1>
            <p>–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –ø–ª–∞—Ç–µ–∂—ñ–≤ —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø—ñ–¥–ø–∏—Å–∫–∞–º–∏</p>
            <button class="logout-btn" onclick="adminLogout()">üö™ –í–∏–π—Ç–∏</button>
        </div>

        <div class="container">
            <!-- –û–°–ù–û–í–ù–Ü –°–¢–ê–¢–ò–°–¢–ò–ö–ò -->
            <div class="dashboard-grid">
                <div class="stat-card revenue">
                    <div class="stat-label">üí∞ –ó–∞–≥–∞–ª—å–Ω–∏–π –¥–æ—Ö—ñ–¥</div>
                    <div class="stat-number" id="total-revenue">$0</div>
                    <div class="stat-change">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>
                </div>
                
                <div class="stat-card users">
                    <div class="stat-label">üë• –í—Å—å–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤</div>
                    <div class="stat-number" id="total-users">0</div>
                    <div class="stat-change">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>
                </div>
                
                <div class="stat-card conversion">
                    <div class="stat-label">üìà –ö–æ–Ω–≤–µ—Ä—Å—ñ—è</div>
                    <div class="stat-number" id="conversion-rate">0%</div>
                    <div class="stat-change">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>
                </div>
                
                <div class="stat-card active">
                    <div class="stat-label">‚úÖ –ê–∫—Ç–∏–≤–Ω—ñ –ø—ñ–¥–ø–∏—Å–∫–∏</div>
                    <div class="stat-number" id="active-subscriptions">0</div>
                    <div class="stat-change">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>
                </div>
            </div>

            <!-- SYSTEM HEALTH -->
            <div class="section">
                <div class="section-header">
                    <div class="section-title">üè• –ó–¥–æ—Ä–æ–≤'—è —Å–∏—Å—Ç–µ–º–∏</div>
                    <button class="btn btn-primary" onclick="loadSystemHealth()">üîÑ –û–Ω–æ–≤–∏—Ç–∏</button>
                </div>
                
                <div class="dashboard-grid">
                    <div class="alert alert-info" id="mongodb-status">
                        <strong>üîµ MongoDB:</strong> –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞...<br>
                        <small>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</small>
                    </div>
                    <div class="alert alert-info" id="tron-status">
                        <strong>üîµ TRON API:</strong> –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞...<br>
                        <small>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</small>
                    </div>
                    <div class="alert alert-info" id="automation-status">
                        <strong>üîµ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è:</strong> –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞...<br>
                        <small>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</small>
                    </div>
                    <div class="alert alert-info" id="server-status">
                        <strong>üîµ Server:</strong> –û–Ω–ª–∞–π–Ω<br>
                        <small>–ß–∞—Å —Ä–æ–±–æ—Ç–∏: <span id="server-uptime">–ù–µ–≤—ñ–¥–æ–º–æ</span></small>
                    </div>
                </div>
            </div>

            <!-- RECENT ACTIVITY -->
            <div class="section">
                <div class="section-header">
                    <div class="section-title">üî¥ –û—Å—Ç–∞–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å</div>
                    <button class="btn btn-success" onclick="loadRecentActivity()">
                        üîÑ –û–Ω–æ–≤–∏—Ç–∏ <span class="refresh-indicator hidden" id="activity-spinner"></span>
                    </button>
                </div>
                
                <div class="real-time-log" id="activity-log">
                    <div>[–°–ò–°–¢–ï–ú–ê] –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ª–æ–≥—ñ–≤...</div>
                </div>
            </div>

            <!-- –û–°–¢–ê–ù–ù–Ü –¢–†–ê–ù–ó–ê–ö–¶–Ü–á -->
            <div class="section">
                <div class="section-header">
                    <div class="section-title">üí≥ –û—Å—Ç–∞–Ω–Ω—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó</div>
                    <button class="btn btn-primary" onclick="loadTransactions()">üîÑ –û–Ω–æ–≤–∏—Ç–∏</button>
                </div>
                
                <table class="table">
                    <thead>
                        <tr>
                            <th>‚è∞ –ß–∞—Å</th>
                            <th>üë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á</th>
                            <th>üí∞ –°—É–º–∞</th>
                            <th>üîó –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è</th>
                            <th>üìä –°—Ç–∞—Ç—É—Å</th>
                            <th>ü§ñ –¢–∏–ø</th>
                        </tr>
                    </thead>
                    <tbody id="transactions-table">
                        <tr>
                            <td colspan="6" style="text-align: center; padding: 40px;">
                                –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- QUICK ACTIONS -->
            <div class="section">
                <div class="section-header">
                    <div class="section-title">‚ö° –®–≤–∏–¥–∫—ñ –¥—ñ—ó</div>
                </div>
                
                <div class="dashboard-grid" style="padding: 20px;">
                    <button class="btn btn-primary" onclick="checkTronAPI()" style="padding: 20px;">
                        üîç –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ TRON API
                    </button>
                    <button class="btn btn-success" onclick="testMongoDB()" style="padding: 20px;">
                        üß™ –¢–µ—Å—Ç MongoDB
                    </button>
                    <button class="btn btn-warning" onclick="viewPendingPayments()" style="padding: 20px;">
                        ‚è≥ –û—á—ñ–∫—É—é—á—ñ –ø–ª–∞—Ç–µ–∂—ñ
                    </button>
                    <button class="btn btn-danger" onclick="emergencyAlert()" style="padding: 20px;">
                        üö® –ï–∫—Å—Ç—Ä–µ–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ì–õ–û–ë–ê–õ–¨–ù–Ü –ó–ú–Ü–ù–ù–Ü
        let isLoggedIn = false;
        let adminToken = null;
        let autoRefreshInterval = null;

        // –õ–û–ì–Ü–ù –°–ò–°–¢–ï–ú–ê
        function handlePasswordKeyPress(event) {
            if (event.key === 'Enter') {
                adminLogin();
            }
        }

        async function adminLogin() {
            const password = document.getElementById('admin-password').value;
            const errorDiv = document.getElementById('login-error');
            
            if (!password) {
                showLoginError('–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å');
                return;
            }

            try {
                // –í —Ä–µ–∞–ª—å–Ω—ñ–π —Å–∏—Å—Ç–µ–º—ñ —Ç—É—Ç –±—É–≤ –±–∏ –∑–∞–ø–∏—Ç –¥–æ —Å–µ—Ä–≤–µ—Ä–∞
                // –î–ª—è –¥–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –ø—Ä–æ—Å—Ç–∏–π –ø–∞—Ä–æ–ª—å
                if (password === 'pantelmed_admin_2024') {
                    adminToken = 'demo_token';
                    isLoggedIn = true;
                    
                    document.getElementById('login-section').classList.add('hidden');
                    document.getElementById('admin-panel').classList.remove('hidden');
                    
                    // –ó–∞–ø—É—Å–∫–∞—î–º–æ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—é –ø–∞–Ω–µ–ª—ñ
                    initializeAdminPanel();
                } else {
                    showLoginError('–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –ø–∞—Ä–æ–ª—å');
                }
            } catch (error) {
                console.error('Login error:', error);
                showLoginError('–ü–æ–º–∏–ª–∫–∞ –≤—Ö–æ–¥—É –≤ —Å–∏—Å—Ç–µ–º—É');
            }
        }

        function showLoginError(message) {
            const errorDiv = document.getElementById('login-error');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 3000);
        }

        function adminLogout() {
            isLoggedIn = false;
            adminToken = null;
            
            if (autoRefreshInterval) {
                clearInterval(autoRefreshInterval);
            }
            
            document.getElementById('admin-panel').classList.add('hidden');
            document.getElementById('login-section').classList.remove('hidden');
            document.getElementById('admin-password').value = '';
        }

        // –Ü–ù–Ü–¶–Ü–ê–õ–Ü–ó–ê–¶–Ü–Ø –ü–ê–ù–ï–õ–Ü
        async function initializeAdminPanel() {
            console.log('üöÄ –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –∞–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—ñ...');
            
            // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –≤—Å—ñ –¥–∞–Ω—ñ
            await Promise.all([
                loadSystemHealth(),
                loadDashboardStats(),
                loadTransactions(),
                loadRecentActivity()
            ]);
            
            // –ó–∞–ø—É—Å–∫–∞—î–º–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–∂–Ω—ñ 30 —Å–µ–∫—É–Ω–¥
            autoRefreshInterval = setInterval(() => {
                loadSystemHealth();
                loadRecentActivity();
            }, 30000);
            
            addLogEntry('[–°–ò–°–¢–ï–ú–ê] –ê–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—å —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–∞', 'success');
        }

        // –ó–ê–í–ê–ù–¢–ê–ñ–ï–ù–ù–Ø –î–ê–ù–ò–•
        async function loadSystemHealth() {
            try {
                const response = await fetch('/health');
                const data = await response.json();
                
                // MongoDB —Å—Ç–∞—Ç—É—Å
                const mongoStatus = document.getElementById('mongodb-status');
                if (data.mongodb.status === 'connected' && data.mongodb.connection_test) {
                    mongoStatus.className = 'alert alert-success';
                    mongoStatus.innerHTML = `
                        <strong>üü¢ MongoDB:</strong> –ü—ñ–¥–∫–ª—é—á–µ–Ω–∞<br>
                        <small>–¢–µ—Å—Ç –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: —É—Å–ø—ñ—à–Ω–æ</small>
                    `;
                } else {
                    mongoStatus.className = 'alert alert-danger';
                    mongoStatus.innerHTML = `
                        <strong>üî¥ MongoDB:</strong> –ü—Ä–æ–±–ª–µ–º–∏ –∑ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è–º<br>
                        <small>–°—Ç–∞—Ç—É—Å: ${data.mongodb.status}</small>
                    `;
                }
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è —Å—Ç–∞—Ç—É—Å
                const autoStatus = document.getElementById('automation-status');
                if (data.automation && data.automation.active) {
                    autoStatus.className = 'alert alert-success';
                    autoStatus.innerHTML = `
                        <strong>üü¢ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è:</strong> –ê–∫—Ç–∏–≤–Ω–∞<br>
                        <small>–û—á—ñ–∫—É—é—á–∏—Ö –ø–ª–∞—Ç–µ–∂—ñ–≤: ${data.automation.pending_payments}</small>
                    `;
                } else {
                    autoStatus.className = 'alert alert-warning';
                    autoStatus.innerHTML = `
                        <strong>üü° –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è:</strong> –ù–µ–∞–∫—Ç–∏–≤–Ω–∞<br>
                        <small>–§–æ–Ω–æ–≤–∏–π –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –≤–∏–º–∫–Ω–µ–Ω–∏–π</small>
                    `;
                }
                
                // TRON API (–º–æ–∫—É—î–º–æ –¥–ª—è –¥–µ–º–æ)
                const tronStatus = document.getElementById('tron-status');
                tronStatus.className = 'alert alert-success';
                tronStatus.innerHTML = `
                    <strong>üü¢ TRON API:</strong> –ü—Ä–∞—Ü—é—î<br>
                    <small>–ì–∞–º–∞–Ω–µ—Ü—å: ${data.tron_wallet.substring(0, 20)}...</small>
                `;
                
            } catch (error) {
                console.error('Error loading system health:', error);
                addLogEntry('[–ü–û–ú–ò–õ–ö–ê] –ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º–∏', 'error');
            }
        }

        async function loadDashboardStats() {
            try {
                // –ú–æ–∫—É—î–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è –¥–µ–º–æ
                const mockStats = {
                    total_revenue: Math.floor(Math.random() * 5000) + 1000,
                    total_users: Math.floor(Math.random() * 200) + 50,
                    conversion_rate: Math.floor(Math.random() * 30) + 15,
                    active_subscriptions: Math.floor(Math.random() * 50) + 10
                };
                
                document.getElementById('total-revenue').textContent = '$' + mockStats.total_revenue.toFixed(2);
                document.getElementById('total-users').textContent = mockStats.total_users;
                document.getElementById('conversion-rate').textContent = mockStats.conversion_rate + '%';
                document.getElementById('active-subscriptions').textContent = mockStats.active_subscriptions;
                
                // –û–Ω–æ–≤–ª—é—î–º–æ –æ–ø–∏—Å
                document.querySelectorAll('.stat-change').forEach((el, index) => {
                    const changes = ['+12.5% —Ü—å–æ–≥–æ –º—ñ—Å—è—Ü—è', '+8 —Å—å–æ–≥–æ–¥–Ω—ñ', '-2.1% —Ü—å–æ–≥–æ —Ç–∏–∂–Ω—è', '+5 —Ü—å–æ–≥–æ –¥–Ω—è'];
                    el.textContent = changes[index] || '–û–Ω–æ–≤–ª–µ–Ω–æ';
                });
                
            } catch (error) {
                console.error('Error loading dashboard stats:', error);
            }
        }

        async function loadTransactions() {
            try {
                // –ú–æ–∫—É—î–º–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó –¥–ª—è –¥–µ–º–æ
                const mockTransactions = [
                    {
                        timestamp: new Date(),
                        user_id: 'web_1751190288704_zv1o6p6e7',
                        amount: 2.6,
                        tx_id: '8d40ed13823ee902a1b2c3d4e5f6...',
                        status: 'active',
                        auto_detected: true
                    },
                    {
                        timestamp: new Date(Date.now() - 300000),
                        user_id: 'web_1751190288705_abc123',
                        amount: 0.5,
                        tx_id: 'f1e2d3c4b5a6978511223344...',
                        status: 'pending',
                        auto_detected: false
                    },
                    {
                        timestamp: new Date(Date.now() - 600000),
                        user_id: 'web_1751190288706_def456',
                        amount: 2.6,
                        tx_id: 'a1b2c3d4e5f6978511223344...',
                        status: 'active',
                        auto_detected: true
                    }
                ];
                
                const tbody = document.getElementById('transactions-table');
                tbody.innerHTML = '';
                
                mockTransactions.forEach(tx => {
                    const row = createTransactionRow(tx);
                    tbody.appendChild(row);
                });
                
                addLogEntry('[–î–ê–ù–Ü] –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó –æ–Ω–æ–≤–ª–µ–Ω–æ', 'info');
                
            } catch (error) {
                console.error('Error loading transactions:', error);
                addLogEntry('[–ü–û–ú–ò–õ–ö–ê] –ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó', 'error');
            }
        }

        function createTransactionRow(tx) {
            const row = document.createElement('tr');
            
            const statusClass = {
                'active': 'status-active',
                'pending': 'status-pending', 
                'failed': 'status-failed'
            }[tx.status] || 'status-pending';
            
            row.innerHTML = `
                <td>${tx.timestamp.toLocaleString('uk-UA')}</td>
                <td><code>${tx.user_id.substring(0, 20)}...</code></td>
                <td><strong>$${tx.amount}</strong></td>
                <td><code>${tx.tx_id.substring(0, 16)}...</code></td>
                <td><span class="status-badge ${statusClass}">${tx.status}</span></td>
                <td>${tx.auto_detected ? 'ü§ñ –ê–≤—Ç–æ' : 'üë§ –†—É—á–Ω–∏–π'}</td>
            `;
            
            return row;
        }

        async function loadRecentActivity() {
            const spinner = document.getElementById('activity-spinner');
            spinner.classList.remove('hidden');
            
            try {
                // –°–∏–º—É–ª—é—î–º–æ –Ω–æ–≤—É –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å
                const activities = [
                    '[TRON] –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–æ–≤–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π...',
                    '[API] –í—ñ–¥–ø–æ–≤—ñ–¥—å TRON API: 200 OK',
                    '[DB] –ó–∞–ø–∏—Ç –¥–æ MongoDB —É—Å–ø—ñ—à–Ω–∏–π',
                    '[MONITOR] –û–±—Ä–æ–±–∫–∞ –ø–ª–∞—Ç–µ–∂—É...',
                    '[SUCCESS] –ü–ª–∞—Ç—ñ–∂ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ: $2.60',
                    '[INFO] –ê–∫—Ç–∏–≤–Ω–∏—Ö –ø—ñ–¥–ø–∏—Å–æ–∫: ' + (Math.floor(Math.random() * 50) + 20)
                ];
                
                const randomActivity = activities[Math.floor(Math.random() * activities.length)];
                addLogEntry(randomActivity, 'info');
                
            } catch (error) {
                addLogEntry('[–ü–û–ú–ò–õ–ö–ê] –ù–µ –≤–¥–∞–ª–æ—Å—è –æ–Ω–æ–≤–∏—Ç–∏ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å', 'error');
            } finally {
                spinner.classList.add('hidden');
            }
        }

        // –õ–û–ì–£–í–ê–ù–ù–Ø
        function addLogEntry(message, type = 'info') {
            const log = document.getElementById('activity-log');
            const entry = document.createElement('div');
            
            const colors = {
                success: '#00ff00',
                warning: '#ffff00',
                error: '#ff0000',
                info: '#00ffff'
            };
            
            const timestamp = new Date().toLocaleTimeString();
            entry.style.color = colors[type] || colors.info;
            entry.textContent = `[${timestamp}] ${message}`;
            
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
            
            // –û–±–º–µ–∂—É—î–º–æ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Å—ñ–≤
            while (log.children.length > 50) {
                log.removeChild(log.firstChild);
            }
        }

        // –®–í–ò–î–ö–Ü –î–Ü–á
        async function checkTronAPI() {
            try {
                addLogEntry('[API] –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ TRON API...', 'info');
                const response = await fetch('/debug-tron');
                const data = await response.json();
                
                if (data.status === 'ok') {
                    addLogEntry(`[API] TRON –ø—Ä–∞—Ü—é—î: ${data.transactions_count} —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π`, 'success');
                } else {
                    addLogEntry('[API] TRON API –ø–æ–º–∏–ª–∫–∞: ' + data.error, 'error');
                }
            } catch (error) {
                addLogEntry('[API] –ù–µ –≤–¥–∞–ª–æ—Å—è –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ TRON API', 'error');
            }
        }

        async function testMongoDB() {
            addLogEntry('[DB] –¢–µ—Å—Ç—É—î–º–æ MongoDB –∑\'—î–¥–Ω–∞–Ω–Ω—è...', 'info');
            await loadSystemHealth();
            addLogEntry('[DB] –¢–µ—Å—Ç MongoDB –∑–∞–≤–µ—Ä—à–µ–Ω–æ', 'success');
        }

        function viewPendingPayments() {
            addLogEntry('[MONITOR] –ü–µ—Ä–µ–≥–ª—è–¥ –æ—á—ñ–∫—É—é—á–∏—Ö –ø–ª–∞—Ç–µ–∂—ñ–≤...', 'info');
            // –¢—É—Ç –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –∑ –¥–µ—Ç–∞–ª—è–º–∏
            alert('–û—á—ñ–∫—É—é—á–∏—Ö –ø–ª–∞—Ç–µ–∂—ñ–≤: ' + Math.floor(Math.random() * 5));
        }

        function emergencyAlert() {
            const confirmed = confirm('–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –µ–∫—Å—Ç—Ä–µ–Ω–µ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—É?');
            if (confirmed) {
                addLogEntry('[ALERT] –ï–∫—Å—Ç—Ä–µ–Ω–µ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ', 'warning');
                alert('–°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ! –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –∑–≤\'—è–∂–µ—Ç—å—Å—è –∑ –≤–∞–º–∏ –Ω–∞–π–±–ª–∏–∂—á–∏–º —á–∞—Å–æ–º.');
            }
        }

        // –ê–í–¢–û–ú–ê–¢–ò–ß–ù–ï –û–ù–û–í–õ–ï–ù–ù–Ø –ß–ê–°–£
        setInterval(() => {
            const serverUptime = document.getElementById('server-uptime');
            if (serverUptime) {
                const uptime = Math.floor(Math.random() * 48) + 24;
                serverUptime.textContent = `${uptime}–≥ ${Math.floor(Math.random() * 60)}—Ö–≤`;
            }
        }, 60000);
    </script>
</body>
</html>
